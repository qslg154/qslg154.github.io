<!DOCTYPE html>







<html lang="en-us" data-theme="">
<head>
    
        
<meta charset="utf-8">
<meta name="HandheldFriendly" content="True">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="referrer" content="no-referrer-when-downgrade">
<meta name="theme-name" content="Anubis2">

<title>Resultant Notes - qslg154</title>

<meta name="description" content="

    
        #
    
    Multiplication as linear map


Let $p, q$ have degree $m, n\geq 1$ and $R$ be an integral domain.
Consider the linear map $\phi : R_{n-1}[x]\times R_{m-1}[x] \rightarrow R_{a&#43;b-1}[x]$ by:

$$\phi(r, s) = pr &#43; qs$$
Theorem 1
$\mathrm{Im}\ \phi$  is isomorphic to some $kR_{a&#43;b-1}[x]$ for $k \in R$ if and only if $p, q$ don&rsquo;t have a common factor of positive degree over $Frac(R)$.

Proof: If $\phi$ is invertible, then $\phi(r, s) = pr&#43;qs = c$ for some $r, s$ since $\phi$ is surjective. The constant polynomial $c$ assert that no such factor exist. Conversely, if $p, q$ don&rsquo;t have such factor then we can consider the equation $pr = -qs$ , since $p, q$ are coprime over $Frac(R)$,
$p$ must divide $s$ , but $\deg s &lt; m$ so $s = 0$ . Similarly $r=0$ , we have $\ker \phi = {(0, 0)}$, so $\phi$ is injective, thus is an isomorphism .">





<link rel="icon" type="image/x-icon" href="/favicon.ico">
<link rel="apple-touch-icon-precomposed" href="/favicon.png">














<style>
  body {
    visibility: hidden;
    opacity: 0;
  }
</style>

<noscript>
  <style>
    body {
      visibility: visible;
      opacity: 1;
    }
  </style>
</noscript>




    





    
    
        
    
    

    
        <link rel="stylesheet" href="/css/style.min.44f8240afd8df81b52565c4119ac5ae247776c77fc6d7ccf6e101a6c98abfa7a.css" integrity="sha256-RPgkCv2N&#43;BtSVlxBGaxa4kd3bHf8bXzPbhAabJir&#43;no=">
    





    





    
    
        
    
    

    
        <link rel="stylesheet" href="/css/style.min.c4c04b3ef88e3d619ad4c7ee5e03048422bc55c4fefdc1f07657c1133670aa22.css" integrity="sha256-xMBLPviOPWGa1MfuXgMEhCK8VcT&#43;/cHwdlfBEzZwqiI=">
    





    





    
    
        
    
    

    
        <link rel="stylesheet" href="/css/style.min.21c5d8fe0a79d623b0adc1ce4bd4f6dd2c05cd939c9aaaa966ba7186b1464f4d.css" integrity="sha256-IcXY/gp51iOwrcHOS9T23SwFzZOcmqqpZrpxhrFGT00=">
    























    

    





    
    
        
    
    

    
        <script src="/js/script.min.08f04d96386c73c9bf4d160333f8f448c05a6e01c06770542ee0e013954ce930.js" type="text/javascript" charset="utf-8" integrity="sha256-CPBNljhsc8m/TRYDM/j0SMBabgHAZ3BULuDgE5VM6TA="></script>
    


















    
</head>
<body>
    <a class="skip-main" href="#main">Skip to main content</a>
    <div class="container">
        <header class="common-header">
            
                <div class="header-top">
    <div class="header-top-left">
        <h1 class="site-title noselect">
    <a href="/">qslg154</a>
</h1>

        











    
        <div class="theme-switcher">
            <span class="inline-svg">

    


    
    
    
    
    

    <svg  xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="icon icon-tabler icons-tabler-outline icon-tabler-sun-high"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M14.828 14.828a4 4 0 1 0 -5.656 -5.656a4 4 0 0 0 5.656 5.656z" /><path d="M6.343 17.657l-1.414 1.414" /><path d="M6.343 6.343l-1.414 -1.414" /><path d="M17.657 6.343l1.414 -1.414" /><path d="M17.657 17.657l1.414 1.414" /><path d="M4 12h-2" /><path d="M12 4v-2" /><path d="M20 12h2" /><path d="M12 20v2" /></svg>


</span>

        </div>
    

    <script>
        const STORAGE_KEY = 'user-color-scheme'
        const defaultTheme = "light"

        let currentTheme
        let switchButton
        let autoDefinedScheme = window.matchMedia('(prefers-color-scheme: dark)')

        function switchTheme(e) {
            currentTheme = (currentTheme === 'dark') ? 'light' : 'dark';
            if (localStorage) localStorage.setItem(STORAGE_KEY, currentTheme);
            document.documentElement.setAttribute('data-theme', currentTheme);
            changeGiscusTheme(currentTheme);
            document.body.dispatchEvent(new CustomEvent(currentTheme + "-theme-set"));
        }

        const autoChangeScheme = e => {
            currentTheme = e.matches ? 'dark' : 'light'
            document.documentElement.setAttribute('data-theme', currentTheme);
            changeGiscusTheme(currentTheme);
            document.body.dispatchEvent(new CustomEvent(currentTheme + "-theme-set"));
        }

        document.addEventListener('DOMContentLoaded', function () {
            switchButton = document.querySelector('.theme-switcher')
            currentTheme = detectCurrentScheme()

            if (currentTheme === 'auto') {
                autoChangeScheme(autoDefinedScheme);
                autoDefinedScheme.addListener(autoChangeScheme);
            } else {
                document.documentElement.setAttribute('data-theme', currentTheme)
            }

            if (switchButton) {
                switchButton.addEventListener('click', switchTheme, false)
            }

            showContent();
        })

        function detectCurrentScheme() {
            if (localStorage !== null && localStorage.getItem(STORAGE_KEY)) {
                return localStorage.getItem(STORAGE_KEY)
            }
            if (defaultTheme) {
                return defaultTheme
            }
            return window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';
        }

        function showContent() {
            document.body.style.visibility = 'visible';
            document.body.style.opacity = 1;
        }

        function changeGiscusTheme (theme) {
            function sendMessage(message) {
              const iframe = document.querySelector('iframe.giscus-frame');
              if (!iframe) return;
              iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
            }

            sendMessage({
              setConfig: {
                theme: theme
              }
            });
        }
    </script>


        <ul class="social-icons noselect">

 











    <li>
            <a href="/index.xml" title="RSS" rel="me">
            <span class="inline-svg">

    


    
    
    
    
    

    <svg  xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="icon icon-tabler icons-tabler-outline icon-tabler-rss"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M5 19m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0" /><path d="M4 4a16 16 0 0 1 16 16" /><path d="M4 11a9 9 0 0 1 9 9" /></svg>


</span>

            </a>
        </li>
    

</ul>

    </div>
    <div class="header-top-right">

    </div>
</div>


    <nav class="noselect">
        
        
        <a class="" href="/" title="">Home</a>
        
        <a class="" href="/about/" title="">About</a>
        
        <a class="" href="/tags/" title="">Tags</a>
        
        <a class="" href="/posts/" title="">Archive</a>
        
    </nav>





    
    




    <script>
  MathJax = {
    tex: {
      inlineMath: [['$', '$'], ['\\(', '\\)']],
      displayMath: [['$$','$$'], ['\\[', '\\]']],
      processEscapes: true,
      processEnvironments: true
    },
    options: {
      skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre']
    }
  };

  window.addEventListener('load', (event) => {
      document.querySelectorAll("mjx-container").forEach(function(x){
        x.parentElement.classList += 'has-jax'})
    });

</script>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script type="text/javascript" id="MathJax-script" async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>






            
        </header>
        <main id="main" tabindex="-1">
            
    

    <article class="post h-entry">
        <div class="post-header">
            <header>
                
                
                
                <h1 class="p-name post-title ">Resultant Notes</h1>
                

            </header>
            



<div class="post-info noselect">
    
        <div class="post-date dt-published">
            <time datetime="2026-01-14">2026-01-14</time>
            
        </div>
    

    <a class="post-hidden-url u-url" href="/posts/resultant-notes/">/posts/resultant-notes/</a>
    <a href="/" class="p-name p-author post-hidden-author h-card" rel="me">map[name:qslg154]</a>


    <div class="post-taxonomies">
        
        
        
    </div>
</div>

        </div>
        

  
  




  
  
  
  <details class="toc noselect">
    <summary>Table of Contents</summary>
    <div class="inner"><nav id="TableOfContents">
  <ul>
    <li><a href="#multiplication-as-linear-map">Multiplication as linear map</a></li>
    <li><a href="#defining-the-resultant">Defining the resultant</a></li>
    <li><a href="#cool-applications">Cool applications</a>
      <ul>
        <li><a href="#hkcert2025-bivariate-copper">hkcert2025: Bivariate Copper</a></li>
      </ul>
    </li>
  </ul>
</nav></div>
  </details>
  



<script>
  var toc = document.querySelector(".toc");
  if (toc) {
    toc.addEventListener("click", function () {
      if (event.target.tagName !== "A") {
        event.preventDefault();
        if (this.open) {
          this.open = false;
          this.classList.remove("expanded");
        } else {
          this.open = true;
          this.classList.add("expanded");
        }
      }
    });
  }
</script>

        <div class="content e-content">
            <h2 id="multiplication-as-linear-map" >
<div>
    <a href="#multiplication-as-linear-map">
        #
    </a>
    Multiplication as linear map
</div>
</h2>
<p>Let $p, q$ have degree $m, n\geq 1$ and $R$ be an integral domain.
Consider the linear map $\phi : R_{n-1}[x]\times R_{m-1}[x] \rightarrow R_{a+b-1}[x]$ by:
</p>
$$\phi(r, s) = pr + qs$$<blockquote>
<p><em>Theorem 1</em>
$\mathrm{Im}\ \phi$  is isomorphic to some $kR_{a+b-1}[x]$ for $k \in R$ if and only if $p, q$ don&rsquo;t have a common factor of positive degree over $Frac(R)$.</p>
</blockquote>
<p><em>Proof</em>: If $\phi$ is invertible, then $\phi(r, s) = pr+qs = c$ for some $r, s$ since $\phi$ is surjective. The constant polynomial $c$ assert that no such factor exist. Conversely, if $p, q$ don&rsquo;t have such factor then we can consider the equation $pr = -qs$ , since $p, q$ are coprime over $Frac(R)$,<br>
$p$ must divide $s$ , but $\deg s < m$ so $s = 0$ . Similarly $r=0$ , we have $\ker \phi = {(0, 0)}$, so $\phi$ is injective, thus is an isomorphism .</p>
<p>We can write out the matrix of $\phi$ and calculate its determinant to determine whether $\phi$ is an isomorphism, and whether $p, q$ have a common factor (thus common zero possibly over some field extension)</p>
<blockquote>
<p><em>Remark:</em> The condition of common factor over $Frac$ is to prevent issues of non-UFD</p>
</blockquote>
<h2 id="defining-the-resultant" >
<div>
    <a href="#defining-the-resultant">
        #
    </a>
    Defining the resultant
</div>
</h2>
<p>Let $p = a_mx^m+...+a_0, q = b_n^n+...+b_0$
The matrix of $\phi$ , under the basis $\{1, x, x^2, ..., x^{m+n-1}\}$ is:</p>
$$M = Mat(\phi)= \begin{pmatrix} 
a_0      & 0           & \cdots & 0          & b_0        & 0              & \cdots & 0       \\
a_1    & a_0       & \cdots & 0           & b_1     & b_0           & \cdots & 0  \\
a_2    & a_1     & \ddots & 0           & b_2     & b_1         & \ddots & 0 \\
\vdots  &\vdots   & \ddots & a_0        & \vdots   &\vdots       & \ddots & b_0  \\
a_m       & a_{m-1} & \cdots & \vdots   & b_n       & b_{n-1}     & \cdots & \vdots\\
0          & a_m       & \ddots &  \vdots  & 0          & b_n          & \ddots &  \vdots  \\
\vdots  & \vdots   & \ddots & a_{m-1}  & \vdots  & \vdots      & \ddots & b_{n-1}   \\
0          & 0          & \cdots  & a_m       & 0           & 0              & \cdots & b_n   
\end{pmatrix}$$<blockquote>
<p>This is called the <em>Sylvester matrix</em></p>
</blockquote>
<p>We can define the resultant of $p, q$: $\mathrm{Res}(p, q) = \det(M)$ , since for any polynomial $f$,
$f$ has repeated root if and only $f, f'$ has common zero, we can define $\mathrm{Disc}(f)$ = $\mathrm{Res}(f, f')$ .</p>
<blockquote>
<p><em>Corollary 2:</em> $Res(p, q) = 0$ if and only $p, q$ share common zeros (possibly over some field extensions)</p>
</blockquote>
<h2 id="cool-applications" >
<div>
    <a href="#cool-applications">
        #
    </a>
    Cool applications
</div>
</h2>
<blockquote>
<p><em>Theorem 3:</em> $\bar{\mathbb{Q}}$ set of algebraic number is closed under addition and multiplication</p>
</blockquote>
<p>The idea is to use resultant to construct some bivariate polynomial such that when taking resultant regarding to some variable, we have the resultant, which is a single variable polynomial vanish at the points we need.</p>
<p><em>Proof:</em> let $x, y \in \bar{\mathbb{Q}}$ , then $p(x) = q(y) = 0$ for some $p, q$ $\in \mathbb{Q}[x]$ .
The polynomial
</p>
$$ r(z) = \mathrm{Res}_x(p(x), q(z-x)) $$<p>
has root $x+y$ , and the polynomial
</p>
$$ t(z) = \mathrm{Res}_x(p(x), x^nq(z/x))$$<p>
has root $xy$ .</p>
<blockquote>
<p>Such proof applies for $\bar{\mathbb{Z}}$ also.</p>
</blockquote>
<p>The method of resultant also comes handy for constructing polynomials for coppersmith attack.</p>
<h3 id="hkcert2025-bivariate-copper" >
<div>
    <a href="#hkcert2025-bivariate-copper">
        ##
    </a>
    hkcert2025: Bivariate Copper
</div>
</h3>
<div class="highlight"><pre tabindex="0" style="color:#c6d0f5;background-color:#303446;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#81c8be">from</span> <span style="color:#ef9f76">Crypto.Util.number</span> <span style="color:#81c8be">import</span> <span style="color:#99d1db;font-weight:bold">*</span>
</span></span><span style="display:flex;"><span><span style="color:#81c8be">from</span> <span style="color:#ef9f76">sage.all</span> <span style="color:#81c8be">import</span> <span style="color:#99d1db;font-weight:bold">*</span>
</span></span><span style="display:flex;"><span>message <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#e78284">b</span><span style="color:#a6d189">&#39;?&#39;</span>
</span></span><span style="display:flex;"><span>flag <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#e78284">b</span><span style="color:#a6d189">&#39;?&#39;</span> 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>m <span style="color:#99d1db;font-weight:bold">=</span> bytes_to_long(flag)
</span></span><span style="display:flex;"><span>message <span style="color:#99d1db;font-weight:bold">=</span> bytes_to_long(message)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>p <span style="color:#99d1db;font-weight:bold">=</span> getPrime(<span style="color:#ef9f76">1024</span>)
</span></span><span style="display:flex;"><span>q <span style="color:#99d1db;font-weight:bold">=</span> getPrime(<span style="color:#ef9f76">25</span>)
</span></span><span style="display:flex;"><span>N <span style="color:#99d1db;font-weight:bold">=</span> p <span style="color:#99d1db;font-weight:bold">*</span> q
</span></span><span style="display:flex;"><span>e <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#ef9f76">65537</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>c <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#99d1db">pow</span>(message, e, N)
</span></span><span style="display:flex;"><span>r1, r2 <span style="color:#99d1db;font-weight:bold">=</span> getPrime(<span style="color:#ef9f76">512</span>), getPrime(<span style="color:#ef9f76">512</span>)
</span></span><span style="display:flex;"><span>k <span style="color:#99d1db;font-weight:bold">=</span> getPrime(<span style="color:#ef9f76">64</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>T1 <span style="color:#99d1db;font-weight:bold">=</span> (k <span style="color:#99d1db;font-weight:bold">*</span> inverse(m <span style="color:#99d1db;font-weight:bold">+</span> r1, p)) <span style="color:#99d1db;font-weight:bold">%</span> p
</span></span><span style="display:flex;"><span>T2 <span style="color:#99d1db;font-weight:bold">=</span> (k <span style="color:#99d1db;font-weight:bold">*</span> inverse(m <span style="color:#99d1db;font-weight:bold">+</span> r2, p)) <span style="color:#99d1db;font-weight:bold">%</span> p
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>l1 <span style="color:#99d1db;font-weight:bold">=</span> T1 <span style="color:#99d1db;font-weight:bold">//</span> <span style="color:#ef9f76">2</span> <span style="color:#99d1db;font-weight:bold">**</span> <span style="color:#ef9f76">244</span>
</span></span><span style="display:flex;"><span>l2 <span style="color:#99d1db;font-weight:bold">=</span> T2 <span style="color:#99d1db;font-weight:bold">//</span> <span style="color:#ef9f76">2</span> <span style="color:#99d1db;font-weight:bold">**</span> <span style="color:#ef9f76">244</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#737994;font-style:italic"># print(f&#39;{e = }&#39;)</span>
</span></span><span style="display:flex;"><span><span style="color:#737994;font-style:italic"># print(f&#39;{N = }&#39;)</span>
</span></span><span style="display:flex;"><span><span style="color:#737994;font-style:italic"># print(f&#39;{c = }&#39;)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#737994;font-style:italic"># print(f&#39;{k = }&#39;)</span>
</span></span><span style="display:flex;"><span><span style="color:#737994;font-style:italic"># print(f&#39;{r1 = }&#39;)</span>
</span></span><span style="display:flex;"><span><span style="color:#737994;font-style:italic"># print(f&#39;{r2 = }&#39;)</span>
</span></span><span style="display:flex;"><span><span style="color:#737994;font-style:italic"># print(f&#39;{leak1 = }&#39;)</span>
</span></span><span style="display:flex;"><span><span style="color:#737994;font-style:italic"># print(f&#39;{leak2 = }&#39;)</span>
</span></span></code></pre></div><p>We can factor $N$ easily by brute force, and notice that we have</p>
$$\begin{align} T_i(m+r_i) - k = 0 \pmod{p}\\\end{align}$$<p>This suggest that we can take</p>
$$ p(t_1, t_2) = \mathrm{Res}_m( T_1(m+r_1) - k,  T_2(m+r_2) - k ) = 0$$<p>by writing $T_i$ as $2^{244}l_i+t_i$ , where $t_i$ are the low bits that we don&rsquo;t know.
We can solve $t_1, t_2$ by using standard coppersmith method.</p>

        </div>

    </article>

    
    

    
        
        
    

    

    
        


    

    

    
    
    
        <script>
  MathJax = {
    tex: {
      inlineMath: [['$', '$'], ['\\(', '\\)']],
      displayMath: [['$$','$$'], ['\\[', '\\]']],
      processEscapes: true,
      processEnvironments: true
    },
    options: {
      skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre']
    }
  };

  window.addEventListener('load', (event) => {
      document.querySelectorAll("mjx-container").forEach(function(x){
        x.parentElement.classList += 'has-jax'})
    });

</script>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script type="text/javascript" id="MathJax-script" async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

    

        </main>
        
            <footer class="common-footer noselect">
    
    

    <div class="common-footer-bottom">
        

        <div style="display: flex; align-items: center; gap:8px">
            Â©  qslg154,  2026
            
        </div>
        <div style="display:flex; align-items: center; gap:4px">

            
            

            
            
            
            

            
            

            
        </div>
        
            <div>
                Powered by <a target="_blank" rel="noopener noreferrer" href="https://gohugo.io/">Hugo</a>, theme <a target="_blank" rel="noopener noreferrer" href="https://github.com/hugo-theme-anubis2/hugo-theme-anubis2">Anubis2</a>.<br>
            </div>
        
    </div>

    <p class="h-card vcard">

    <a href=/ class="p-name u-url url fn" rel="me">map[name:qslg154]</a>

    

    
</p>

</footer>

        
    </div>
</body>
</html>
